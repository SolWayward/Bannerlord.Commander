<Prefab>
  <Window>
    <!-- Full screen dark background container -->
    <Widget WidthSizePolicy="StretchToParent" 
            HeightSizePolicy="StretchToParent"
            Sprite="BlankWhiteSquare_9"
            Color="#1a1a1aEE">
      <Children>
        
        <!-- Header Bar -->
        <Widget WidthSizePolicy="StretchToParent"
                HeightSizePolicy="Fixed"
                SuggestedHeight="60"
                VerticalAlignment="Top"
                Sprite="BlankWhiteSquare_9"
                Color="#2a2a2aFF">
          <Children>
            
            <!-- Decorative top border line -->
            <Widget WidthSizePolicy="StretchToParent"
                    HeightSizePolicy="Fixed"
                    SuggestedHeight="2"
                    VerticalAlignment="Top"
                    Sprite="BlankWhiteSquare_9"
                    Color="#8B7355FF" />
            
            <!-- Title Text - Centered -->
            <RichTextWidget WidthSizePolicy="StretchToParent"
                            HeightSizePolicy="StretchToParent"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Brush="TownManagement.Description.Title.Text"
                            Brush.FontSize="28"
                            Brush.TextHorizontalAlignment="Center"
                            Text="@TitleText" />
            
            <!-- Filter Input (Top Right) -->
            <Widget WidthSizePolicy="CoverChildren"
                    HeightSizePolicy="Fixed"
                    SuggestedHeight="36"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    MarginRight="20">
              <Children>
                <!-- Filter Label -->
                <TextWidget WidthSizePolicy="CoverChildren"
                            HeightSizePolicy="StretchToParent"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Brush="Clan.TabControl.Text"
                            Brush.FontSize="18"
                            Text="Filter"
                            MarginRight="8" />
                
                <!-- Filter Text Input Container -->
                <Widget WidthSizePolicy="Fixed"
                        HeightSizePolicy="StretchToParent"
                        SuggestedWidth="220"
                        MarginLeft="45"
                        Sprite="BlankWhiteSquare_9"
                        Color="#1a1a1aFF">
                  <Children>
                    <!-- Border frame for input -->
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Top"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Bottom"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Left"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Right"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    
                    <!-- Actual text input -->
                    <EditableTextWidget WidthSizePolicy="StretchToParent"
                                        HeightSizePolicy="StretchToParent"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        MarginLeft="8"
                                        MarginRight="8"
                                        MarginTop="4"
                                        MarginBottom="4"
                                        Brush="Clan.TabControl.Text"
                                        Brush.FontSize="16"
                                        Text="@FilterText" />
                  </Children>
                </Widget>
              </Children>
            </Widget>
            
            <!-- Decorative bottom border line -->
            <Widget WidthSizePolicy="StretchToParent"
                    HeightSizePolicy="Fixed"
                    SuggestedHeight="2"
                    VerticalAlignment="Bottom"
                    Sprite="BlankWhiteSquare_9"
                    Color="#8B7355FF" />
                    
          </Children>
        </Widget>
        
        <!-- Mode Toggle Tabs Row (below header) -->
        <Widget WidthSizePolicy="StretchToParent"
                HeightSizePolicy="Fixed"
                SuggestedHeight="42"
                MarginTop="60"
                Sprite="BlankWhiteSquare_9"
                Color="#1E1E1EFF">
          <Children>
            
            <!-- Horizontal container for mode tabs -->
            <ListPanel WidthSizePolicy="CoverChildren"
                       HeightSizePolicy="StretchToParent"
                       HorizontalAlignment="Center"
                       VerticalAlignment="Bottom"
                       LayoutImp.LayoutMethod="HorizontalLeftToRight">
              <Children>
                
                <!-- Kingdoms Tab -->
                <ButtonWidget DoNotPassEventsToChildren="true"
                              UpdateChildrenStates="true"
                              WidthSizePolicy="Fixed"
                              HeightSizePolicy="Fixed"
                              SuggestedWidth="180"
                              SuggestedHeight="40"
                              MarginLeft="2"
                              MarginRight="2"
                              Brush="Commander.Tab.Button"
                              Command.Click="ExecuteSelectKingdoms"
                              IsSelected="@IsKingdomsSelected">
                  <Children>
                    <!-- Subtle border frame -->
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Top"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Bottom"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Left"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Right"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <TextWidget WidthSizePolicy="StretchToParent"
                                HeightSizePolicy="StretchToParent"
                                Brush="Clan.TabControl.Text"
                                Text="Kingdoms"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center" />
                  </Children>
                </ButtonWidget>
                
                <!-- Clans Tab -->
                <ButtonWidget DoNotPassEventsToChildren="true"
                              UpdateChildrenStates="true"
                              WidthSizePolicy="Fixed"
                              HeightSizePolicy="Fixed"
                              SuggestedWidth="180"
                              SuggestedHeight="40"
                              MarginLeft="2"
                              MarginRight="2"
                              Brush="Commander.Tab.Button"
                              Command.Click="ExecuteSelectClans"
                              IsSelected="@IsClansSelected">
                  <Children>
                    <!-- Subtle border frame -->
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Top"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Bottom"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Left"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Right"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <TextWidget WidthSizePolicy="StretchToParent"
                                HeightSizePolicy="StretchToParent"
                                Brush="Clan.TabControl.Text"
                                Text="Clans"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center" />
                  </Children>
                </ButtonWidget>
                
                <!-- Heroes Tab -->
                <ButtonWidget DoNotPassEventsToChildren="true"
                              UpdateChildrenStates="true"
                              WidthSizePolicy="Fixed"
                              HeightSizePolicy="Fixed"
                              SuggestedWidth="180"
                              SuggestedHeight="40"
                              MarginLeft="2"
                              MarginRight="2"
                              Brush="Commander.Tab.Button"
                              Command.Click="ExecuteSelectHeroes"
                              IsSelected="@IsHeroesSelected">
                  <Children>
                    <!-- Subtle border frame -->
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Top"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Bottom"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Left"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Right"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <TextWidget WidthSizePolicy="StretchToParent"
                                HeightSizePolicy="StretchToParent"
                                Brush="Clan.TabControl.Text"
                                Text="Heroes"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center" />
                  </Children>
                </ButtonWidget>
                
                <!-- Settlements Tab -->
                <ButtonWidget DoNotPassEventsToChildren="true"
                              UpdateChildrenStates="true"
                              WidthSizePolicy="Fixed"
                              HeightSizePolicy="Fixed"
                              SuggestedWidth="180"
                              SuggestedHeight="40"
                              MarginLeft="2"
                              MarginRight="2"
                              Brush="Commander.Tab.Button"
                              Command.Click="ExecuteSelectSettlements"
                              IsSelected="@IsSettlementsSelected">
                  <Children>
                    <!-- Subtle border frame -->
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Top"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Bottom"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Left"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Right"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <TextWidget WidthSizePolicy="StretchToParent"
                                HeightSizePolicy="StretchToParent"
                                Brush="Clan.TabControl.Text"
                                Text="Settlements"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center" />
                  </Children>
                </ButtonWidget>
                
                <!-- Troops Tab -->
                <ButtonWidget DoNotPassEventsToChildren="true"
                              UpdateChildrenStates="true"
                              WidthSizePolicy="Fixed"
                              HeightSizePolicy="Fixed"
                              SuggestedWidth="180"
                              SuggestedHeight="40"
                              MarginLeft="2"
                              MarginRight="2"
                              Brush="Commander.Tab.Button"
                              Command.Click="ExecuteSelectTroops"
                              IsSelected="@IsTroopsSelected">
                  <Children>
                    <!-- Subtle border frame -->
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Top"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Bottom"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Left"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Right"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <TextWidget WidthSizePolicy="StretchToParent"
                                HeightSizePolicy="StretchToParent"
                                Brush="Clan.TabControl.Text"
                                Text="Troops"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center" />
                  </Children>
                </ButtonWidget>
                
                <!-- Items Tab -->
                <ButtonWidget DoNotPassEventsToChildren="true"
                              UpdateChildrenStates="true"
                              WidthSizePolicy="Fixed"
                              HeightSizePolicy="Fixed"
                              SuggestedWidth="180"
                              SuggestedHeight="40"
                              MarginLeft="2"
                              MarginRight="2"
                              Brush="Commander.Tab.Button"
                              Command.Click="ExecuteSelectItems"
                              IsSelected="@IsItemsSelected">
                  <Children>
                    <!-- Subtle border frame -->
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Top"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Bottom"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Left"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Right"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <TextWidget WidthSizePolicy="StretchToParent"
                                HeightSizePolicy="StretchToParent"
                                Brush="Clan.TabControl.Text"
                                Text="Items"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center" />
                  </Children>
                </ButtonWidget>
                
                <!-- Characters Tab -->
                <ButtonWidget DoNotPassEventsToChildren="true"
                              UpdateChildrenStates="true"
                              WidthSizePolicy="Fixed"
                              HeightSizePolicy="Fixed"
                              SuggestedWidth="180"
                              SuggestedHeight="40"
                              MarginLeft="2"
                              MarginRight="2"
                              Brush="Commander.Tab.Button"
                              Command.Click="ExecuteSelectCharacters"
                              IsSelected="@IsCharactersSelected">
                  <Children>
                    <!-- Subtle border frame -->
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Top"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="1" VerticalAlignment="Bottom"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Left"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="1" HorizontalAlignment="Right"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <TextWidget WidthSizePolicy="StretchToParent"
                                HeightSizePolicy="StretchToParent"
                                Brush="Clan.TabControl.Text"
                                Text="Characters"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center" />
                  </Children>
                </ButtonWidget>
                
              </Children>
            </ListPanel>
            
            <!-- Bottom border line that connects to content area -->
            <Widget WidthSizePolicy="StretchToParent"
                    HeightSizePolicy="Fixed"
                    SuggestedHeight="2"
                    VerticalAlignment="Bottom"
                    Sprite="BlankWhiteSquare_9"
                    Color="#3D3D3DFF" />
            
          </Children>
        </Widget>
        
        <!-- Main Content Area (below mode tabs) -->
        <Widget WidthSizePolicy="StretchToParent"
                HeightSizePolicy="StretchToParent"
                MarginTop="104"
                MarginBottom="60"
                MarginLeft="20"
                MarginRight="20">
          <Children>
            
            <!-- HEROES MODE CONTENT -->
            <Widget WidthSizePolicy="StretchToParent"
                    HeightSizePolicy="StretchToParent"
                    IsVisible="@IsHeroesSelected">
              <Children>
                
                <!-- Container with border -->
                <Widget WidthSizePolicy="StretchToParent"
                        HeightSizePolicy="StretchToParent"
                        Sprite="BlankWhiteSquare_9"
                        Color="#2a2a2aFF">
                  <Children>
                    
                    <!-- Border frame -->
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="2" VerticalAlignment="Top"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                            SuggestedHeight="2" VerticalAlignment="Bottom"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="2" HorizontalAlignment="Left"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                            SuggestedWidth="2" HorizontalAlignment="Right"
                            Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                    
                    <!-- Content area with margin -->
                    <Widget WidthSizePolicy="StretchToParent"
                            HeightSizePolicy="StretchToParent"
                            MarginTop="10"
                            MarginBottom="10"
                            MarginLeft="10"
                            MarginRight="10">
                      <Children>
                        
                        <!-- Column Headers -->
                        <Widget WidthSizePolicy="StretchToParent"
                                HeightSizePolicy="Fixed"
                                SuggestedHeight="40"
                                MarginTop="0"
                                VerticalAlignment="Top"
                                Sprite="BlankWhiteSquare_9"
                                Color="#3a3a3aFF">
                          <Children>
                            <!-- Header Row Layout -->
                            <ListPanel WidthSizePolicy="StretchToParent"
                                       HeightSizePolicy="StretchToParent"
                                       LayoutImp.LayoutMethod="HorizontalLeftToRight">
                              <Children>
                                
                                <!-- Name Column Header (Clickable) -->
                                <ButtonWidget DoNotPassEventsToChildren="true"
                                              WidthSizePolicy="Fixed"
                                              HeightSizePolicy="StretchToParent"
                                              SuggestedWidth="200"
                                              MarginLeft="10"
                                              Command.Click="ExecuteSortByName">
                                  <Children>
                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                HeightSizePolicy="StretchToParent"
                                                Brush="TownManagement.Description.Title.Text"
                                                Brush.FontSize="20"
                                                Text="@NameSortIndicatorText"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center" />
                                  </Children>
                                </ButtonWidget>
                                
                                <!-- Gender Column Header (Clickable) -->
                                <ButtonWidget DoNotPassEventsToChildren="true"
                                              WidthSizePolicy="Fixed"
                                              HeightSizePolicy="StretchToParent"
                                              SuggestedWidth="80"
                                              MarginLeft="10"
                                              Command.Click="ExecuteSortByGender">
                                  <Children>
                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                HeightSizePolicy="StretchToParent"
                                                Brush="TownManagement.Description.Title.Text"
                                                Brush.FontSize="20"
                                                Text="@GenderSortIndicatorText"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center" />
                                  </Children>
                                </ButtonWidget>
                                
                                <!-- Age Column Header (Clickable) -->
                                <ButtonWidget DoNotPassEventsToChildren="true"
                                              WidthSizePolicy="Fixed"
                                              HeightSizePolicy="StretchToParent"
                                              SuggestedWidth="50"
                                              MarginLeft="10"
                                              Command.Click="ExecuteSortByAge">
                                  <Children>
                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                HeightSizePolicy="StretchToParent"
                                                Brush="TownManagement.Description.Title.Text"
                                                Brush.FontSize="20"
                                                Text="@AgeSortIndicatorText"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center" />
                                  </Children>
                                </ButtonWidget>
                                
                                <!-- Clan Column Header (Clickable) -->
                                <ButtonWidget DoNotPassEventsToChildren="true"
                                              WidthSizePolicy="Fixed"
                                              HeightSizePolicy="StretchToParent"
                                              SuggestedWidth="150"
                                              MarginLeft="10"
                                              Command.Click="ExecuteSortByClan">
                                  <Children>
                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                HeightSizePolicy="StretchToParent"
                                                Brush="TownManagement.Description.Title.Text"
                                                Brush.FontSize="20"
                                                Text="@ClanSortIndicatorText"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center" />
                                  </Children>
                                </ButtonWidget>
                                
                                <!-- Kingdom Column Header (Clickable) -->
                                <ButtonWidget DoNotPassEventsToChildren="true"
                                              WidthSizePolicy="Fixed"
                                              HeightSizePolicy="StretchToParent"
                                              SuggestedWidth="150"
                                              MarginLeft="10"
                                              Command.Click="ExecuteSortByKingdom">
                                  <Children>
                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                HeightSizePolicy="StretchToParent"
                                                Brush="TownManagement.Description.Title.Text"
                                                Brush.FontSize="20"
                                                Text="@KingdomSortIndicatorText"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center" />
                                  </Children>
                                </ButtonWidget>
                                
                                <!-- Culture Column Header (Clickable) -->
                                <ButtonWidget DoNotPassEventsToChildren="true"
                                              WidthSizePolicy="Fixed"
                                              HeightSizePolicy="StretchToParent"
                                              SuggestedWidth="120"
                                              MarginLeft="10"
                                              Command.Click="ExecuteSortByCulture">
                                  <Children>
                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                HeightSizePolicy="StretchToParent"
                                                Brush="TownManagement.Description.Title.Text"
                                                Brush.FontSize="20"
                                                Text="@CultureSortIndicatorText"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center" />
                                  </Children>
                                </ButtonWidget>
                                
                                <!-- Type Column Header (Clickable) -->
                                <ButtonWidget DoNotPassEventsToChildren="true"
                                              WidthSizePolicy="Fixed"
                                              HeightSizePolicy="StretchToParent"
                                              SuggestedWidth="110"
                                              MarginLeft="10"
                                              Command.Click="ExecuteSortByType">
                                  <Children>
                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                HeightSizePolicy="StretchToParent"
                                                Brush="TownManagement.Description.Title.Text"
                                                Brush.FontSize="20"
                                                Text="@TypeSortIndicatorText"
                                                HorizontalAlignment="Left"
                                                VerticalAlignment="Center" />
                                  </Children>
                                </ButtonWidget>
                                
                                <!-- Level Column Header (Clickable) -->
                                <ButtonWidget DoNotPassEventsToChildren="true"
                                              WidthSizePolicy="Fixed"
                                              HeightSizePolicy="StretchToParent"
                                              SuggestedWidth="50"
                                              MarginLeft="10"
                                              Command.Click="ExecuteSortByLevel">
                                  <Children>
                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                HeightSizePolicy="StretchToParent"
                                                Brush="TownManagement.Description.Title.Text"
                                                Brush.FontSize="20"
                                                Text="@LevelSortIndicatorText"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center" />
                                  </Children>
                                </ButtonWidget>
                                
                              </Children>
                            </ListPanel>
                            
                            <!-- Bottom border for header -->
                            <Widget WidthSizePolicy="StretchToParent"
                                    HeightSizePolicy="Fixed"
                                    SuggestedHeight="2"
                                    VerticalAlignment="Bottom"
                                    Sprite="BlankWhiteSquare_9"
                                    Color="#8B7355FF" />
                          </Children>
                        </Widget>
                        
                        <!-- Scrollable Data Rows Container -->
                        <Widget WidthSizePolicy="StretchToParent"
                                HeightSizePolicy="StretchToParent"
                                MarginTop="42">
                          <Children>
                            
                            <!-- ScrollablePanel with proper ClipRect, InnerPanel, and Scrollbar references -->
                            <ScrollablePanel Id="HeroesScrollablePanel"
                                             WidthSizePolicy="StretchToParent"
                                             HeightSizePolicy="StretchToParent"
                                             MarginRight="25"
                                             AutoHideScrollBars="true"
                                             ClipRect="HeroesClipRect"
                                             InnerPanel="HeroesClipRect\HeroesInnerPanel"
                                             VerticalScrollbar="..\ScrollbarContainer\HeroesScrollbar">
                              <Children>
                                
                                <!-- ClipRect that clips the content -->
                                <Widget Id="HeroesClipRect"
                                        WidthSizePolicy="StretchToParent"
                                        HeightSizePolicy="StretchToParent"
                                        ClipContents="true">
                                  <Children>
                                    
                                    <!-- Inner panel that holds the list and can scroll -->
                                    <ListPanel Id="HeroesInnerPanel"
                                               WidthSizePolicy="StretchToParent"
                                               HeightSizePolicy="CoverChildren"
                                               DataSource="{Heroes}"
                                               StackLayout.LayoutMethod="VerticalBottomToTop">
                                      <ItemTemplate>
                                        
                                        <!-- Hero Row as ButtonWidget for selection -->
                                        <ButtonWidget DoNotPassEventsToChildren="true"
                                                      UpdateChildrenStates="true"
                                                      WidthSizePolicy="StretchToParent"
                                                      HeightSizePolicy="Fixed"
                                                      SuggestedHeight="35"
                                                      MarginBottom="2"
                                                      Brush="Commander.HeroRow"
                                                      Command.Click="ExecuteSelect"
                                                      IsSelected="@IsSelected">
                                          <Children>
                                            
                                            <!-- Row data layout -->
                                            <ListPanel WidthSizePolicy="StretchToParent"
                                                       HeightSizePolicy="StretchToParent"
                                                       StackLayout.LayoutMethod="HorizontalLeftToRight">
                                              <Children>
                                                
                                                <!-- Name Column -->
                                                <Widget WidthSizePolicy="Fixed"
                                                        HeightSizePolicy="StretchToParent"
                                                        SuggestedWidth="200"
                                                        MarginLeft="10">
                                                  <Children>
                                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                                HeightSizePolicy="StretchToParent"
                                                                Brush="Clan.TabControl.Text"
                                                                Brush.FontSize="18"
                                                                Text="@Name"
                                                                HorizontalAlignment="Left"
                                                                VerticalAlignment="Center" />
                                                  </Children>
                                                </Widget>
                                                
                                                <!-- Gender Column -->
                                                <Widget WidthSizePolicy="Fixed"
                                                        HeightSizePolicy="StretchToParent"
                                                        SuggestedWidth="80"
                                                        MarginLeft="10">
                                                  <Children>
                                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                                HeightSizePolicy="StretchToParent"
                                                                Brush="Clan.TabControl.Text"
                                                                Brush.FontSize="18"
                                                                Text="@Gender"
                                                                HorizontalAlignment="Left"
                                                                VerticalAlignment="Center" />
                                                  </Children>
                                                </Widget>
                                                
                                                <!-- Age Column -->
                                                <Widget WidthSizePolicy="Fixed"
                                                        HeightSizePolicy="StretchToParent"
                                                        SuggestedWidth="50"
                                                        MarginLeft="10">
                                                  <Children>
                                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                                HeightSizePolicy="StretchToParent"
                                                                Brush="Clan.TabControl.Text"
                                                                Brush.FontSize="18"
                                                                Text="@AgeText"
                                                                HorizontalAlignment="Center"
                                                                VerticalAlignment="Center" />
                                                  </Children>
                                                </Widget>
                                                
                                                <!-- Clan Column -->
                                                <Widget WidthSizePolicy="Fixed"
                                                        HeightSizePolicy="StretchToParent"
                                                        SuggestedWidth="150"
                                                        MarginLeft="10">
                                                  <Children>
                                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                                HeightSizePolicy="StretchToParent"
                                                                Brush="Clan.TabControl.Text"
                                                                Brush.FontSize="18"
                                                                Text="@Clan"
                                                                HorizontalAlignment="Left"
                                                                VerticalAlignment="Center" />
                                                  </Children>
                                                </Widget>
                                                
                                                <!-- Kingdom Column -->
                                                <Widget WidthSizePolicy="Fixed"
                                                        HeightSizePolicy="StretchToParent"
                                                        SuggestedWidth="150"
                                                        MarginLeft="10">
                                                  <Children>
                                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                                HeightSizePolicy="StretchToParent"
                                                                Brush="Clan.TabControl.Text"
                                                                Brush.FontSize="18"
                                                                Text="@Kingdom"
                                                                HorizontalAlignment="Left"
                                                                VerticalAlignment="Center" />
                                                  </Children>
                                                </Widget>
                                                
                                                <!-- Culture Column -->
                                                <Widget WidthSizePolicy="Fixed"
                                                        HeightSizePolicy="StretchToParent"
                                                        SuggestedWidth="120"
                                                        MarginLeft="10">
                                                  <Children>
                                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                                HeightSizePolicy="StretchToParent"
                                                                Brush="Clan.TabControl.Text"
                                                                Brush.FontSize="18"
                                                                Text="@Culture"
                                                                HorizontalAlignment="Left"
                                                                VerticalAlignment="Center" />
                                                  </Children>
                                                </Widget>
                                                
                                                <!-- Type Column -->
                                                <Widget WidthSizePolicy="Fixed"
                                                        HeightSizePolicy="StretchToParent"
                                                        SuggestedWidth="110"
                                                        MarginLeft="10">
                                                  <Children>
                                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                                HeightSizePolicy="StretchToParent"
                                                                Brush="Clan.TabControl.Text"
                                                                Brush.FontSize="18"
                                                                Text="@HeroType"
                                                                HorizontalAlignment="Left"
                                                                VerticalAlignment="Center" />
                                                  </Children>
                                                </Widget>
                                                
                                                <!-- Level Column -->
                                                <Widget WidthSizePolicy="Fixed"
                                                        HeightSizePolicy="StretchToParent"
                                                        SuggestedWidth="50"
                                                        MarginLeft="10">
                                                  <Children>
                                                    <TextWidget WidthSizePolicy="StretchToParent"
                                                                HeightSizePolicy="StretchToParent"
                                                                Brush="Clan.TabControl.Text"
                                                                Brush.FontSize="18"
                                                                Text="@LevelText"
                                                                HorizontalAlignment="Center"
                                                                VerticalAlignment="Center" />
                                                  </Children>
                                                </Widget>
                                                
                                              </Children>
                                            </ListPanel>
                                            
                                          </Children>
                                        </ButtonWidget>
                                        
                                      </ItemTemplate>
                                    </ListPanel>
                                    
                                  </Children>
                                </Widget>
                                
                              </Children>
                            </ScrollablePanel>
                            
                            <!-- Scrollbar Container -->
                            <Widget Id="ScrollbarContainer"
                                    WidthSizePolicy="Fixed"
                                    HeightSizePolicy="StretchToParent"
                                    SuggestedWidth="25"
                                    HorizontalAlignment="Right">
                              <Children>
                                <ScrollbarWidget Id="HeroesScrollbar"
                                                 WidthSizePolicy="Fixed"
                                                 HeightSizePolicy="StretchToParent"
                                                 SuggestedWidth="20"
                                                 MinValue="0"
                                                 MaxValue="100"
                                                 AlignmentAxis="Vertical"
                                                 HorizontalAlignment="Center"
                                                 VerticalAlignment="Top"
                                                 Handle="ScrollbarHandle">
                                  <Children>
                                    <Widget Id="ScrollbarHandle"
                                            WidthSizePolicy="Fixed"
                                            HeightSizePolicy="Fixed"
                                            SuggestedWidth="20"
                                            MinHeight="30"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Top"
                                            Sprite="BlankWhiteSquare_9"
                                            Color="#8B7355FF" />
                                  </Children>
                                </ScrollbarWidget>
                              </Children>
                            </Widget>
                            
                          </Children>
                        </Widget>
                        
                      </Children>
                    </Widget>
                    
                  </Children>
                </Widget>
                
              </Children>
            </Widget>
            <!-- END HEROES MODE CONTENT -->
            
          </Children>
        </Widget>
        
        <!-- Footer Bar -->
        <Widget WidthSizePolicy="StretchToParent"
                HeightSizePolicy="Fixed"
                SuggestedHeight="50"
                VerticalAlignment="Bottom"
                Sprite="BlankWhiteSquare_9"
                Color="#2a2a2aFF">
          <Children>
            
            <!-- Decorative top border line -->
            <Widget WidthSizePolicy="StretchToParent"
                    HeightSizePolicy="Fixed"
                    SuggestedHeight="2"
                    VerticalAlignment="Top"
                    Sprite="BlankWhiteSquare_9"
                    Color="#8B7355FF" />
            
            <!-- Status Indicator (bottom left in footer) -->
            <Widget WidthSizePolicy="Fixed"
                    HeightSizePolicy="Fixed"
                    SuggestedWidth="200"
                    SuggestedHeight="36"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    MarginLeft="25"
                    Sprite="BlankWhiteSquare_9"
                    Color="#252525DD">
              <Children>
                <!-- Border frame -->
                <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                        SuggestedHeight="1" VerticalAlignment="Top"
                        Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                <Widget WidthSizePolicy="StretchToParent" HeightSizePolicy="Fixed"
                        SuggestedHeight="1" VerticalAlignment="Bottom"
                        Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                        SuggestedWidth="1" HorizontalAlignment="Left"
                        Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                <Widget WidthSizePolicy="Fixed" HeightSizePolicy="StretchToParent"
                        SuggestedWidth="1" HorizontalAlignment="Right"
                        Sprite="BlankWhiteSquare_9" Color="#8B7355FF" />
                
                <!-- Status text with padding -->
                <TextWidget WidthSizePolicy="StretchToParent"
                            HeightSizePolicy="StretchToParent"
                            Brush="TownManagement.Description.Title.Text"
                            Brush.FontSize="16"
                            Text="@LoadingStatusText"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            MarginLeft="8"
                            MarginRight="8" />
              </Children>
            </Widget>
            
            <!-- Close button -->
            <ButtonWidget DoNotPassEventsToChildren="true"
                          UpdateChildrenStates="true"
                          WidthSizePolicy="Fixed"
                          HeightSizePolicy="Fixed"
                          SuggestedWidth="120"
                          SuggestedHeight="36"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          Command.Click="ExecuteClose">
              <Children>
                <TextWidget WidthSizePolicy="StretchToParent"
                            HeightSizePolicy="StretchToParent"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Brush="Clan.TabControl.Text"
                            Text="Close" />
              </Children>
            </ButtonWidget>
            
          </Children>
        </Widget>
        
      </Children>
    </Widget>
  </Window>
</Prefab>
